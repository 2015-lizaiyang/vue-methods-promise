{"version":3,"file":"vue-methods-promise.js","sources":["../src/isPromise.js","../src/methodsPromise.js","../src/index.js"],"sourcesContent":["export default function isPromise (obj) {\n  return !!obj && typeof obj === 'object' && typeof obj.constructor === 'function' && !Object.hasOwnProperty.call(obj, 'constructor') && obj.constructor.name === 'Promise'\n}\n","import isPromise from './isPromise'\n\nexport default (opt = {}) => {\n  // Configure the hook function\n  if (typeof opt.hookName !== 'string') {\n    opt.hookName = '$promise'\n  }\n  // Global hook function\n  if (typeof opt.promise !== 'function') {\n    opt.promise = (mp) => {\n      mp.catch((err) => {\n        if (process.env.NODE_ENV !== 'production') {\n          console.log(err)\n        }\n      })\n    }\n  }\n\n  return {\n    beforeCreate () {\n      const { methods } = this.$options\n      if (!Object.prototype.toString.call(methods) === '[object Object]') return\n      Object.keys(methods).forEach((k) => {\n        let fn = methods[k]\n        if (typeof fn === 'function' && k !== opt.hookName) {\n          methods[k] = (...arg) => {\n            let back = fn.apply(this, arg)\n            if (isPromise(back)) {\n              if (typeof this[opt.hookName] === 'function') {\n                if (isPromise(this[opt.hookName](back))) {\n                  opt.promise.call(this, back)\n                }\n              } else {\n                opt.promise.call(this, back)\n              }\n            }\n          }\n        }\n      })\n    }\n  }\n}\n","import methodsPromise from './methodsPromise'\n\nexport default function install (Vue, opt) {\n  if (install.installed) return // already installed\n\n  Vue.mixin(methodsPromise(opt))\n}\n"],"names":["isPromise","obj","constructor","Object","hasOwnProperty","call","name","opt","hookName","promise","mp","catch","err","process","env","NODE_ENV","log","methods","$options","prototype","toString","keys","forEach","k","fn","arg","back","apply","install","Vue","installed","mixin","methodsPromise"],"mappings":";;;;;;;;;;;;AAAe,SAASA,SAAT,CAAoBC,GAApB,EAAyB;SAC/B,CAAC,CAACA,GAAF,IAAS,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAxB,IAAoC,OAAOA,IAAIC,WAAX,KAA2B,UAA/D,IAA6E,CAACC,OAAOC,cAAP,CAAsBC,IAAtB,CAA2BJ,GAA3B,EAAgC,aAAhC,CAA9E,IAAgIA,IAAIC,WAAJ,CAAgBI,IAAhB,KAAyB,SAAhK;;;ACCF,sBAAe,YAAc;MAAbC,GAAa,uEAAP,EAAO;;;MAEvB,OAAOA,IAAIC,QAAX,KAAwB,QAA5B,EAAsC;QAChCA,QAAJ,GAAe,UAAf;;;MAGE,OAAOD,IAAIE,OAAX,KAAuB,UAA3B,EAAuC;QACjCA,OAAJ,GAAc,UAACC,EAAD,EAAQ;SACjBC,KAAH,CAAS,UAACC,GAAD,EAAS;YACZC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;kBACjCC,GAAR,CAAYJ,GAAZ;;OAFJ;KADF;;;SASK;gBAAA,0BACW;;;UACNK,OADM,GACM,KAAKC,QADX,CACND,OADM;;UAEV,CAACd,OAAOgB,SAAP,CAAiBC,QAAjB,CAA0Bf,IAA1B,CAA+BY,OAA/B,CAAD,KAA6C,iBAAjD,EAAoE;aAC7DI,IAAP,CAAYJ,OAAZ,EAAqBK,OAArB,CAA6B,UAACC,CAAD,EAAO;YAC9BC,KAAKP,QAAQM,CAAR,CAAT;YACI,OAAOC,EAAP,KAAc,UAAd,IAA4BD,MAAMhB,IAAIC,QAA1C,EAAoD;kBAC1Ce,CAAR,IAAa,YAAY;8CAARE,GAAQ;iBAAA;;;gBACnBC,OAAOF,GAAGG,KAAH,QAAeF,GAAf,CAAX;gBACIzB,UAAU0B,IAAV,CAAJ,EAAqB;kBACf,OAAO,MAAKnB,IAAIC,QAAT,CAAP,KAA8B,UAAlC,EAA8C;oBACxCR,UAAU,MAAKO,IAAIC,QAAT,EAAmBkB,IAAnB,CAAV,CAAJ,EAAyC;sBACnCjB,OAAJ,CAAYJ,IAAZ,QAAuBqB,IAAvB;;eAFJ,MAIO;oBACDjB,OAAJ,CAAYJ,IAAZ,QAAuBqB,IAAvB;;;WARN;;OAHJ;;GAJJ;CAhBF;;ACAe,SAASE,OAAT,CAAkBC,GAAlB,EAAuBtB,GAAvB,EAA4B;MACrCqB,QAAQE,SAAZ,EAAuB,OADkB;;MAGrCC,KAAJ,CAAUC,eAAezB,GAAf,CAAV;;;;;"}